// ignore_for_file: public_member_api_docs, sort_constructors_first
import 'package:carousel_slider/carousel_slider.dart';
import 'package:flutter/material.dart';
import 'package:get/get.dart';
import 'package:sizer/sizer.dart';

import 'package:fashio/ui/pages/home/components/components.dart';
import 'package:fashio/ui/pages/login/components/components.dart';
import 'package:fashio/ui/shared/components/texts.dart';
import 'package:fashio/utils/constants.dart';

class HomeScreen extends StatelessWidget {
  HomeScreen({Key? key}) : super(key: key);
  final RxInt _current = 0.obs;
  final CarouselController _controller = CarouselController();
  final TextEditingController _searchController = TextEditingController();

  @override
  Widget build(BuildContext context) {
    return SafeArea(
        child: Scaffold(
            appBar: AppBar(
              leadingWidth: 44,
              leading: const Padding(
                padding: EdgeInsets.only(left: 10.0),
                child: Logo(),
              ),
              actions: [
                AppIcons.iconSearch,
                AppSize.kSizedBox10w,
                Padding(
                  padding: const EdgeInsets.symmetric(horizontal: 10),
                  child: AppIcons.iconNotification,
                )
              ],
              backgroundColor: AppColor.kWhite,
              elevation: 0,
            ),
            body: SingleChildScrollView(
              child: Column(
                mainAxisSize: MainAxisSize.min,
                children: [
                  Padding(
                    padding:
                        const EdgeInsets.only(left: 10, right: 10, top: 20),
                    child: Row(
                      mainAxisAlignment: MainAxisAlignment.end,
                      children: const [],
                    ),
                  ),
                  AppSize.kSizedBox20h,
                  CustomBanner(
                    controller: _controller,
                    current: _current,
                    title: 'Super Flash Sale \n 50% off',
                    // offer: '50',
                    imageList: imgList,
                    subRow: Row(
                      mainAxisAlignment: MainAxisAlignment.spaceBetween,
                      children: [
                        TimeContainer(time: '08'),
                        const CustomColon(),
                        TimeContainer(time: '34'),
                        const CustomColon(),
                        TimeContainer(time: '52'),
                      ],
                    ),
                  ),
                  Obx(() {
                    return Row(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: imgList.asMap().entries.map((entry) {
                        return GestureDetector(
                          onTap: () {
                            _controller.animateToPage(entry.key);
                            // print('======${entry.key}===========');
                          },
                          child: Container(
                            width: 8.0,
                            height: 8.0,
                            margin: const EdgeInsets.symmetric(
                                vertical: 8.0, horizontal: 4.0),
                            decoration: BoxDecoration(
                              shape: BoxShape.circle,
                              // ignore: unrelated_type_equality_checks
                              color: _current == entry.key
                                  ? AppColor.kThemeBlue
                                  : AppColor.kDarkWhite,
                            ),
                          ),
                        );
                      }).toList(),
                    );
                  }),
                  AppSize.kSizedBox20h,
                  const TextBar(
                      firstTitle: 'Catetgory', secondTitle: 'More Category'),
                  AppSize.kSizedBox20h,
                  SizedBox(
                    height: 12.h,
                    child: ListView.builder(
                      scrollDirection: Axis.horizontal,
                      itemBuilder: (context, index) {
                        return CategoryRound(
                            index: index, imgSrc: imgList[index]);
                      },
                      itemCount: 10,
                      shrinkWrap: true,
                    ),
                  ),
                  AppSize.kSizedBox10h,
                  const TextBar(
                      firstTitle: 'Flash Sale', secondTitle: 'See More'),
                  AppSize.kSizedBox10h,
                  SizedBox(
                    height: 33.h,
                    child: ListView.builder(
                      scrollDirection: Axis.horizontal,
                      itemCount: 6,
                      itemBuilder: (BuildContext context, int index) {
                        return Padding(
                          padding: const EdgeInsets.only(
                            left: 8,
                            top: 8,
                            bottom: 8,
                            right: 4,
                          ),
                          child: ProductCard(
                              imgSrc: imgList[index],
                              name: 'FS - Nike Air max 270 React new',
                              currentPrize: '2999',
                              originalPrize: '4999',
                              offer: '24'),
                        );
                      },
                    ),
                  ),
                  const TextBar(
                      firstTitle: 'Mega Sale', secondTitle: 'see more'),
                  AppSize.kSizedBox10h,
                  SizedBox(
                    height: 33.h,
                    child: ListView.builder(
                      scrollDirection: Axis.horizontal,
                      itemCount: 6,
                      itemBuilder: (BuildContext context, int index) {
                        return Padding(
                          padding: const EdgeInsets.only(
                            left: 8,
                            top: 8,
                            bottom: 8,
                            right: 4,
                          ),
                          child: ProductCard(
                              imgSrc: imgList[index],
                              name: 'FS - Nike Air max 270 React new',
                              currentPrize: '2999',
                              originalPrize: '4999',
                              offer: '24'),
                        );
                      },
                    ),
                  ),
                  CustomBanner(
                    controller: _controller,
                    current: _current,
                    title: 'Recommended \nProduct ',
                    // offer: 'Product',
                    imageList: imgList,
                    subRow:
                        Padding(
                          padding: const EdgeInsets.all(10.0),
                          child: const SubTitle(text: 'We recommend the Best for you',color: AppColor.kWhite,),
                        ),
                  ),
                  AppSize.kSizedBox10h,
                  SizedBox(
                    height: 60.h,
                    child: GridView.builder(
                      gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(
                        crossAxisCount: 2,
                      ),
                      itemCount: 4,
                      itemBuilder: (BuildContext context, int index) {
                        return Padding(
                          padding: const EdgeInsets.all(8.0),
                          child: ProductCard(
                                  imgSrc: imgList[index],
                                  name: 'FS - Nike Air max 270 React new',
                                  currentPrize: '₹2999',
                                  originalPrize: '₹4999',
                                  offer: '24'),
                        );
                      },
                    ),
                  ),
                ],
              ),
            )));
  }
}

class ProductCard extends StatelessWidget {
  final String imgSrc;
  final String name;
  final String currentPrize;
  final String originalPrize;
  final String offer;
  const ProductCard({
    Key? key,
    required this.imgSrc,
    required this.name,
    required this.currentPrize,
    required this.originalPrize,
    required this.offer,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return Container(
      decoration: BoxDecoration(
        border: Border.all(width: 1, color: AppColor.kDarkWhite),
        borderRadius: BorderRadius.circular(4),
      ),
      // padding: const EdgeInsets.only(left: 4,top: 8,bottom: 8,right: 4),
      child: Container(
        margin: const EdgeInsets.all(14),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Container(
              height: 14.h,
              width: 30.w,
              decoration: BoxDecoration(
                color: AppColor.kThemeBlue,
                borderRadius: BorderRadius.circular(4.0),
                image: DecorationImage(
                  image: NetworkImage(imgSrc),
                  fit: BoxFit.cover,
                ),
              ),
            ),
            Padding(
              padding: const EdgeInsets.only(left: 8.0),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  AppSize.kSizedBox10h,
                  CardText(
                    text: name,
                  ),
                  // Row(
                 // children: starsForRatings(),
                  // ),
                  AppSize.kSizedBox10h,
                  HeadTitle(
                      text: '₹$currentPrize',
                      color: AppColor.kThemeBlue,
                      fontSize: 12),
                  AppSize.kSizedBox10h,
                  Row(
                    children: [
                      Text(originalPrize,
                          style: const TextStyle(
                            decoration: TextDecoration.lineThrough,
                            color: AppColor.kLightGrey,
                            fontSize: 10,
                          )),
                      AppSize.kSizedBox10w,
                      HeadTitle(
                        text: '$offer% off',
                        color: AppColor.kNotificationRose,
                        fontSize: 10,
                      ),
                    ],
                  ),
                ],
              ),
            )
          ],
        ),
      ),
    );
  }
}

class CategoryRound extends StatelessWidget {
  final int index;
  final String imgSrc;
  const CategoryRound({
    Key? key,
    required this.index,
    required this.imgSrc,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: const EdgeInsets.only(left: 10, right: 8),
      child: Column(
        children: [
          Container(
            decoration: BoxDecoration(
              border: Border.all(width: 1, color: AppColor.kWhite),
              shape: BoxShape.circle,
              boxShadow: [
                BoxShadow(
                    blurRadius: 1,
                    color: AppColor.kLightGrey.withOpacity(0.8),
                    spreadRadius: 0,
                    // blurStyle: BlurStyle.outer,
                    offset: const Offset(0, 3))
              ],
            ),
            child: CircleAvatar(
              radius: 30.0,
              child: ClipRRect(
                borderRadius: BorderRadius.circular(50.0),
                child: Image.network(
                  imgSrc,
                  fit: BoxFit.fill,
                  scale: 1,
                  width: 60,
                  height: 60,
                ),
              ),
            ),
          ),
          SubTitle(
            text: nameList[index],
            fontSize: 10.sp,
          )
        ],
      ),
    );
  }
}

class CardText extends StatelessWidget {
  final String text;
  final double fontSize;

  const CardText({
    Key? key,
    required this.text,
    this.fontSize = 12,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return SizedBox(
        width: 100,
        child: Text(
          text,
          style: TextStyle(
            color: AppColor.kDarkBluePrimary,
            fontSize: fontSize,
            fontWeight: FontWeight.bold,
            overflow: TextOverflow.ellipsis,
          ),
          maxLines: 2,
        ));
  }
}

class TextBar extends StatelessWidget {
  final String firstTitle;
  final String secondTitle;
  const TextBar({
    Key? key,
    required this.firstTitle,
    required this.secondTitle,
  }) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return Padding(
      padding: const EdgeInsets.symmetric(horizontal: 10.0),
      child: Row(
        mainAxisAlignment: MainAxisAlignment.spaceBetween,
        children: [
          HeadTitle(
            text: firstTitle,
            fontSize: 14,
          ),
          HeadTitle(
            text: secondTitle,
            fontSize: 13,
            color: AppColor.kThemeBlue,
          ),
        ],
      ),
    );
  }
}

const int _rating = 4;
List<Icon> starsForRatings() {
  List<Icon> stars = [];
  for (int i = 0; i < _rating; i++) {
    stars.add(const Icon(
      Icons.star_rate_rounded,
      size: 12,
      color: Colors.yellow,
    ));
  }
  for (int i = 0; i < 5 - _rating; i++) {
    stars.add(const Icon(
      Icons.star_rate_rounded,
      size: 12,
      color: AppColor.kDarkWhite,
      // color: Colors.yellow,
    ));
  }
  return stars;
}
